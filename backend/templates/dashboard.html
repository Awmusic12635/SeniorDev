{% extends 'loggedinbase.html' %}
{% block content %}
{% load widget_tweaks %}
<div class="container">
    <div style="" class="starter-template">
        <div style="margin: 40px;" class="col-md-2 btn btn-info">Total products: {{ numberOfItems }}</div>
        <div style="margin: 40px;" class="col-md-2 btn btn-info">Items in inventory: {{ numberOfItemsInInventory }}</div>
        <div style="margin: 40px;" class="col-md-2 btn btn-info">Items checkout: {{numberOfItemsCheckedOut }}</div>
        <div style="margin: 40px;" class="col-md-2 btn btn-info">Items due today: {{numberOfItemsDueToday}}</div>
    </div>

    <script>
        $(document).ready(function(){
            $('#itemTable').DataTable();

            $('.viewButton').on('click',function(){
                window.location="/item/{{ item_type_id }}/"+$(this).attr('data-id');
            });
            $('.editButton').on('click',function(){
                window.location="/item/{{ item_type_id }}/"+$(this).attr('data-id')+"/edit";
            });
            $('#addItemButton').on('click',function(){
                window.location="/item/{{ item_type_id }}/add";
            });
        });

        $(function(){

            $('#search').keyup(function() {

                $.ajax({
                    type: "POST",
                    url: "/dashboard/search/",
                    data: {
                        'search_text' : $('#search').val(),
                        'csrfmiddlewaretoken' : $("input[name=csrfmiddlewaretoken]").val()
                    },
                    success: searchSuccess,
                    dataType: 'html'
                });

            });

        });

        function searchSuccess(data, textStatus, jqXHR)
        {
            $('#result').html(data);
        }
    </script>

    {% csrf_token %}
    <input type="text" id="search" name="search_text" />
    <div id="tableSearch">
    <table id="itemTable" class="display">
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Model</th>
                <th>Cost</th>
                <th>Available Quantitiy</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody id="result">
        </tbody>
    </table>
    </div>
</div>
{% endblock %}